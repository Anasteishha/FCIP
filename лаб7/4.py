# Вхідні дані
p = 29      # просте число
g = 2       # генератор
b = 9       # закритий ключ Аліси
k = 4       # випадкове число для шифрування
M = 21      # повідомлення

# Обчислення відкритого ключа Аліси
y = pow(g, b, p)
print(f"Відкритий ключ Аліси y = {y}")

# Шифрування повідомлення M
c1 = pow(g, k, p)
c2 = (M * pow(y, k, p)) % p
print(f"Шифротекст: c1 = {c1}, c2 = {c2}")

# Розшифрування шифротексту
s = pow(c1, b, p)

# Знаходження оберненого елемента s за модулем p
def modinv(a, p):
    return pow(a, -1, p)

s_inv = modinv(s, p)

# Відновлення повідомлення
M_decrypted = (c2 * s_inv) % p
print(f"Розшифроване повідомлення M' = {M_decrypted}")

# Перевірка, чи співпадає відновлене повідомлення з оригіналом
print("Відновлене повідомлення співпадає з оригіналом:", M_decrypted == M)
